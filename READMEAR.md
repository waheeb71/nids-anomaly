
# ูุธุงู ูุดู ุงูุชุณูู ุงูุดุจูู ูู ุงูููุช ุงูุญูููู (NIDS) ุจุงุณุชุฎุฏุงู ูุดู ุงูุดุฐูุฐ

![Python](https://img.shields.io/badge/Python-3.11-blue?logo=python\&logoColor=white)
![TensorFlow](https://img.shields.io/badge/TensorFlow-2.12-orange?logo=tensorflow\&logoColor=white)
![Scikit-Learn](https://img.shields.io/badge/Scikit--Learn-1.2-lightgrey?logo=scikitlearn\&logoColor=white)
![GitHub](https://img.shields.io/badge/GitHub-waheeb71-black?logo=github\&logoColor=white)

## ูุธุฑุฉ ุนุงูุฉ

ููุฏู ูุฐุง ุงููุดุฑูุน ุฅูู ุชูููุฐ **ูุธุงู ูุดู ุงูุชุณูู ุงูุดุจูู ูู ุงูููุช ุงูุญูููู (NIDS)** ุจุงุณุชุฎุฏุงู **ูุดู ุงูุดุฐูุฐ ุงููุงุฆู ุนูู ุงูุชุนูู ุงูุขูู**.
ูููู ุจูุฑุงูุจุฉ ุญุฑูุฉ ุงูุดุจูุฉุ ูุงุณุชุฎุฑุงุฌ ุงูููุฒุงุช ุงููููุฉ ูู ุงูุญุฒูุ ููุดู ุงูุฃูุดุทุฉ ุงูุดุงุฐุฉ ุงูุชู ูุฏ ุชุดูุฑ ุฅูู ูุฌูุงุช ุฃู ุฃุฌูุฒุฉ ูุฎุชุฑูุฉ.

ูุฌูุน ุงููุธุงู ุจูู ุนุฏุฉ ููุงุฐุฌ ูุฒูุงุฏุฉ ุงูุฏูุฉ:
**ุงูููุงุฐุฌ ุงููุณุชุฎุฏูุฉ:**

* ๐ข **ุบุงุจุฉ ุงูุงูุนุฒุงู(Isolation Forest - IF)** โ ุชูุดู ุงูุดุฐูุฐ ุงุนุชูุงุฏูุง ุนูู ุชูุฒูุน ุงูููุฒุงุช.
* ๐ต **ุขูุฉ ุงูุฏุนู ุงูุฃุญุงุฏู (One-Class SVM - OCSVM)** โ ุชุญุฏุฏ ุงูุฃููุงุท ุบูุฑ ุงููุนุชุงุฏุฉ ุจุงุณุชุฎุฏุงู ุฃุณููุจ ุงูุฏุนู ุงููุชุฌูู.
* ๐ **ุงููุดููุฑ ุงูุชููุงุฆู (Autoencoder - AE)** โ ูููุณ ุฎุทุฃ ุฅุนุงุฏุฉ ุงูุจูุงุก ูุชุญุฏูุฏ ุณููู ุงูุญุฒู ุบูุฑ ุงูุทุจูุนู.

ูุชู ุงุณุชุฎุฏุงู **ุขููุฉ ุชุตููุช** ููุถุน ุนูุงูุฉ ุนูู ุงูุญุฒูุฉ ุนูู ุฃููุง ุดุงุฐุฉ ุฅุฐุง ุงุชููุช **ูููุฐุฌุงู ุฃู ุฃูุซุฑ**.
ููุง ูุณุชุฎุฏู **ูุงูุฐุฉ ูุชุญุฑูุฉ** ููุชุงุจุนุฉ ุงูุดุฐูุฐุงุช ุงูุฃุฎูุฑุฉ ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงููุญุชูู ุงุฎุชุฑุงููุง ูุน ูุฑูุฑ ุงูููุช.

> **ุงููุงุฆุฏุฉ:** ุงูุงูุชุดุงู ุงููุจูุฑ ูููุฌูุงุช ูููู ูู ููุช ุงูุชุนุทู ููููุน ุชุณุฑุจ ุงูุจูุงูุงุช ุฃู ุงููุดุงุท ุงูุดุจูู ุงูุถุงุฑ.

---

## ุงูููุฒุงุช

ูููู ุงููุธุงู ุจุงุณุชุฎุฑุงุฌ **22 ููุฒุฉ** ูู ูู ุญุฒูุฉ ุฃู ุชุฏูู ุดุจูู:

| ุงูููุฒุฉ                | ุงููุตู                          | ุฃูููุชูุง                                                         |
| --------------------- | ------------------------------ | --------------------------------------------------------------- |
| `bytes_fwd`           | ุนุฏุฏ ุงูุจุงูุชุงุช ุงููุฑุณูุฉ           | ุฒูุงุฏุฉ ุฃู ููุตุงู ุบูุฑ ุทุจูุนู ูุฏ ูุดูุฑ ุฅูู ุชุณุฑุจ ุจูุงูุงุช ุฃู ูุณุญ ุงูุดุจูุฉ. |
| `bytes_bwd`           | ุนุฏุฏ ุงูุจุงูุชุงุช ุงููุณุชูุจูุฉ         | ุงูุงุฑุชูุงุน ุงูููุงุฌุฆ ูุฏ ูุดูุฑ ุฅูู ูุฌูุงุช ูุณุญ ุฃู ููุถุงู.                |
| `pkts_fwd`            | ุงูุญุฒู ุงููุฑุณูุฉ                  | ูุฌูุงุช ุงูููุถ ุฃู DoS ูุฏ ุชุณุจุจ ุฒูุงุฏุฉ ููุงุฌุฆุฉ.                        |
| `pkts_bwd`            | ุงูุญุฒู ุงููุณุชูุจูุฉ                | ุนุฏุฏ ุงูุญุฒู ุงููุงุฑุฏุฉ ุงููุจูุฑ ูุฏ ูุดูุฑ ููุฌูู.                         |
| `duration_ms`         | ูุฏุฉ ุงูุชุฏูู ุจุงููููู ุซุงููุฉ       | ุงูุชุฏููุงุช ุงููุตูุฑุฉ ุฌุฏูุง ุฃู ุงูุทูููุฉ ุฌุฏูุง ูููู ุฃู ุชููู ูุดุจููุฉ.      |
| `pkt_len_mean`        | ูุชูุณุท ุทูู ุงูุญุฒูุฉ               | ุงูุฃุญุฌุงู ุบูุฑ ุงููุนุชุงุฏุฉ ูุฏ ุชููู ุถุงุฑุฉ.                              |
| `pkt_len_std`         | ุงูุงูุญุฑุงู ุงููุนูุงุฑู ูุฃุทูุงู ุงูุญุฒู | ุงูุชุจุงูู ุงูุนุงูู ูุดูุฑ ููุฌูุงุช ูุชูุทุนุฉ.                              |
| `pkt_len_max`         | ุฃูุจุฑ ุทูู ููุญุฒูุฉ                | ุงูุญุฒู ุงููุจูุฑุฉ ุฌุฏูุง ูุฏ ุชููู ุถุงุฑุฉ.                                |
| `pkt_len_min`         | ุฃูู ุทูู ููุญุฒูุฉ                 | ุงูุญุฒู ุงูุตุบูุฑุฉ ุฌุฏูุง ูุฏ ุชุดูุฑ ููุณุญ ุฃู ููุถุงู.                       |
| `pkt_rate`            | ุนุฏุฏ ุงูุญุฒู ูู ุงูุซุงููุฉ           | ุงูุฅุฑุณุงู ุงูุณุฑูุน ูุฏ ูุดูุฑ ููุฌูุงุช DoS ุฃู ูุณุญ.                       |
| `byte_rate`           | ุนุฏุฏ ุงูุจุงูุชุงุช ูู ุงูุซุงููุฉ        | ูุนุฏู ูุฑูุฑ ุนุงูู ูุฏ ูุดูุฑ ูุชุณุฑุจ ุจูุงูุงุช ุฃู ูุฌูุงุช ุญุฌููุฉ.             |
| `syn_count`           | ุนุฏุฏ ุฃุนูุงู SYN                  | ุงูุนุฏ ุงูุนุงูู ูุฏ ูุดูุฑ ููุฌูุงุช ููุถุงู SYN.                           |
| `fin_count`           | ุนุฏุฏ ุฃุนูุงู FIN                  | ุงูุณููู ุบูุฑ ุงูุทุจูุนู ูุฏ ูุดูุฑ ููุณุญ ุฎูู.                            |
| `rst_count`           | ุนุฏุฏ ุฃุนูุงู RST                  | ุฅุนุงุฏุฉ ุงูุชุนููู ุงูููุฑุทุฉ ูุฏ ุชุนุทู ุงูุฌูุณุงุช.                          |
| `psh_count`           | ุนุฏุฏ ุฃุนูุงู PSH                  | ูุจุฑุฒ ุงูุงููุฌุงุฑุงุช ุบูุฑ ุงููุนุชุงุฏุฉ ููุจูุงูุงุช ุงูุชุทุจูููุฉ.                |
| `ack_count`           | ุนุฏุฏ ุฃุนูุงู ACK                  | ุงูุฃููุงุท ุบูุฑ ุงููุนุชุงุฏุฉ ูุฏ ุชุดูุฑ ูููุถู ุฃู ูุฌูุงุช ุนูุณูุฉ.              |
| `retransmissions`     | ุนุฏุฏ ุงูุญุฒู ุงููุนุงุฏ ุฅุฑุณุงููุง       | ุงูุฒูุงุฏุฉ ูุฏ ุชุดูุฑ ููุดุงูู ุดุจูุฉ ุฃู ูุฌูุงุช.                           |
| `out_of_order`        | ุนุฏุฏ ุงูุญุฒู ุบูุฑ ุงููุฑุชุจุฉ          | ูุฏ ูุดูุฑ ููุณุญุ ูุฌูุงุช ุฅุนุงุฏุฉ ุงูุชุดุบููุ ุฃู ุนุฏู ุงุณุชูุฑุงุฑ ุงูุดุจูุฉ.       |
| `small_pkt_ratio`     | ูุณุจุฉ ุงูุญุฒู ุงูุตุบูุฑุฉ             | ูุฌูุงุช ุงูููุถ ุบุงูุจูุง ุชุณุชุฎุฏู ุญุฒู ุตุบูุฑุฉ ูุซูุฑุฉ.                      |
| `idle_time_mean`      | ูุชูุณุท ููุช ุงูุฎููู ุจูู ุงูุญุฒู     | ุงูุฃููุงุช ุงููุตูุฑุฉ ุฃู ุงูุทูููุฉ ุฌุฏูุง ุชูุดู ุงูุดุฐูุฐ.                    |
| `fwd_bwd_ratio_bytes` | ูุณุจุฉ ุงูุจุงูุชุงุช ููุฃูุงู/ููุฎูู     | ุงูุชูุงูุช ุงููุจูุฑ ูุดูุฑ ูุชุณุฑุจ ุจูุงูุงุช ุฃู ูุณุญ.                        |
| `fwd_bwd_ratio_pkts`  | ูุณุจุฉ ุงูุญุฒู ููุฃูุงู/ููุฎูู        | ุงูุชุฏููุงุช ุบูุฑ ุงููุชูุงุฒูุฉ ูุฏ ุชุดูุฑ ููุฌูุงุช.                          |

---

## ููููุฉ ุงูุนูู

1. **ุงูุชูุงุท ุงูุญุฒู ูุงุณุชุฎุฑุงุฌ ุงูููุฒุงุช**
   ุงุณุชุฎุฑุงุฌ ุงูููุฒุงุช ุงูุฑูููุฉ ูู ูู ุญุฒูุฉ ุฃู ุชุฏูู.

2. **ูุดู ุงูุดุฐูุฐ** ุจุงุณุชุฎุฏุงู `AnomalyDetector`:

   * ๐ข Isolation Forest โ `if_score`, `if_anomaly`
   * ๐ต One-Class SVM โ `oc_score`, `oc_anomaly`
   * ๐ Autoencoder โ `ae_score`, `ae_anomaly`

3. **ุขููุฉ ุงูุชุตููุช**

   * ุชูุนุชุจุฑ ุงูุญุฒูุฉ ุดุงุฐุฉ ุฅุฐุง ุงุชููุช **ูููุฐุฌุงู ุฃู ุฃูุซุฑ** (`final_anomaly = True`).

4. **ุงููุงูุฐุฉ ุงููุชุญุฑูุฉ**

   * ุชุชุจุน ุงูุดุฐูุฐ ููู ูุถูู.
   * ูุนุชุจุฑ ุงููุถูู ูุฎุชุฑููุง ุฅุฐุง ุชุฌุงูุฒุช ุงูุดุฐูุฐุงุช ุงูุญุฏ (`host_compromised = True`).

5. **ุงููุนุงูุฌุฉ ูู ุงูููุช ุงูุญูููู**

   * `process_packet()` ููุญุฒู ุงููุฑุฏูุฉ
   * `process_batch()` ูุนุฏุฉ ุญุฒู
   * ุชูุจููุงุช ุญูุฉ ููุญุฒู ุงูุดุงุฐุฉ ูุงููุถูููู ุงููุฎุชุฑููู.

---

## ุงูุชุซุจูุช

```bash
git clone https://github.com/waheeb/nids-anomaly.git
cd nids-anomaly
python3 -m venv ai_env
source ai_env/bin/activate    # ููููุณ/ูุงู
ai_env\Scripts\activate       # ูููุฏูุฒ
pip install -r requirements.txt
```

---

## ุชุฏุฑูุจ ุงูููุงุฐุฌ

ูููู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ุงูููุงุฐุฌ ุนูู ูุฌููุนุงุช ุจูุงูุงุช ูุฎุตุตุฉ (CSV ุชุญุชูู ููุฒุงุช ุญุฑูุฉ ุงูุดุจูุฉ).

```bash
python scripts/train_all.py data/large_train_with_ip.csv
```

**ุฎุทูุงุช ุงูุชุฏุฑูุจ:**

1. ุชุฌููุฒ ุงูุจูุงูุงุช ููุนุงูุฑุชูุง (`StandardScaler`).
2. ุชุฏุฑูุจ ุงูููุงุฐุฌ ุนูู ุงูุญุฑูุฉ ุงูุทุจูุนูุฉ:

   * Isolation Forest
   * One-Class SVM
   * Autoencoder
3. ุชุนููู ุงูุญุฏูุฏ (`IF_THRESHOLD`, `OCSVM_THRESHOLD`, `AE_RECON_ERROR`) ุจูุงุกู ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ.
4. ุญูุธ ุงูููุงุฐุฌ ููุงุณุชุฎุฏุงู ูู ุงูููุช ุงูุญูููู.

---

## ุงูุงุณุชุฎุฏุงู

### ุงุฎุชุจุงุฑ ุญุฒูุฉ ูุงุญุฏุฉ

```python
from inference import AnomalyDetector

detector = AnomalyDetector()
sample_packet = { ... }  # ููุฒุงุช ุงูุญุฒูุฉ
result = detector.predict_single(sample_packet)
print(result)
```

### ุงููุนุงูุฌุฉ ูู ุงูููุช ุงูุญูููู

```python
from realtime import RealTimeNIDS
import time

nids = RealTimeNIDS(window_size=10, threshold=3)
packet = { ... }
result = nids.process_packet(packet)
print(result)
```

### ูุนุงูุฌุฉ ุฏูุนุฉ ุญุฒู

```python
packets = [packet1, packet2, packet3, ...]
results = nids.process_batch(packets)
for res in results:
    print(res)
```

---

## ุชูุณูุฑ ุงููุชุงุฆุฌ

* `final_anomaly = True` โ ุงูุญุฒูุฉ ุชู ุชูููุฒูุง ููุดุจููุฉ.
* `host_compromised = True` โ ุงููุถูู ูุญุชูู ุฃู ูููู ูุฎุชุฑููุง.
* `if_score`, `oc_score`, `ae_score` โ ูุชุงุฆุฌ ูู ูููุฐุฌ ุนูู ุญุฏุฉ.
* `window_anomaly_count` โ ุนุฏุฏ ุงูุดุฐูุฐุงุช ูู ุงููุงูุฐุฉ ุงูุฃุฎูุฑุฉ.

---

## ูููู ุงููุดุฑูุน

```
nids-anomaly/
โ
โโ src/
โ  โโ __pycache__/         # ูููุงุช ุงููุงุด ููุจุงูุซูู
โ  โโ __init__.py          # ุชุนุฑูู ุงูุฏููู ูุญุฒูุฉ ุจุงูุซูู
โ  โโ config.py            # ุฅุนุฏุงุฏุงุช ุงููุดุฑูุน
โ  โโ features.py          # ุงุณุชุฎุฑุงุฌ ุงูููุฒุงุช ูู ุงูุญุฒู
โ  โโ inference.py         # ุชุดุบูู ุงูููุงุฐุฌ ุนูู ุงูุจูุงูุงุช
โ  โโ models.py            # ุชุนุฑูู ููุงุฐุฌ ูุดู ุงูุดุฐูุฐ
โ  โโ preprocess.py        # ุชุญุถูุฑ ุงูุจูุงูุงุช ูุชุฌููุฒูุง
โ  โโ realtime.py          # ุชุดุบูู ุงููุธุงู ูู ุงูููุช ุงูุญูููู
โ  โโ test.py              # ุณูุฑุจุช ููุงุฎุชุจุงุฑ
โ  โโ utils.py             # ูุธุงุฆู ูุณุงุนุฏุฉ ุนุงูุฉ
โ
โโ README.md               # ุชูุซูู ุงููุดุฑูุน
```

---

## ููุงุญุธุงุช

* ุชุฃูุฏ ูู ุชุซุจูุช **TensorFlow/Keras** ูุชุดุบูู Autoencoder.
* ุงุณุชุฎุฏุงู ุงููุงูุฐุฉ ุงููุชุญุฑูุฉ ูุณุงุนุฏ ุนูู ุงูุชุดุงู ุงูุดุฐูุฐ ุงููุณุชูุฑุ ูููู ุชุนุทููู.
* ุชุนุฏูู `window_size` ู`threshold` ููุชุญูู ูู ุงูุญุณุงุณูุฉ.

---

## ุงูุชุฑุฎูุต

ุชุฑุฎูุต MIT โ ุงูุธุฑ [LICENSE](LICENSE).

---

## ุงูุชูุงุตู

* **ุชูุบุฑุงู:** [@SyberSc71](https://t.me/SyberSc71), [@WAT4F](https://t.me/WAT4F)
* **GitHub:** [waheeb71](https://github.com/waheeb71), [cyberlangdev](https://github.com/cyberlangdev)
* **ููุชููุจ:** [Cyber Code](https://www.youtube.com/@cyber_code1)
* **X / ุชููุชุฑ:** [@wa\_\_cys](https://x.com/wa__cys)
* **ุงููููุน:** ุชุนุฒุ ุงูููู

---

## ุงููุคูู / ุงููุทูุฑ

**English:** Waheeb Mahyoob Al-Sharabi
**ุงูุนุฑุจูุฉ:** ููุจ ููููุจ ุงูุดุฑุนุจู

